================================================================================
                           SYRIA GPT API DOCUMENTATION
================================================================================

Version: 1.0.0
Last Updated: 2024
Base URL: http://localhost:8000
API Provider: Google Gemini AI

================================================================================
                                OVERVIEW
================================================================================

Syria GPT is an intelligent Q&A system powered by Google Gemini AI, designed to
provide comprehensive answers about Syria-related topics. The API includes:

- üîê Secure Authentication with JWT tokens
- ü§ñ AI-Powered Q&A using Google Gemini
- üîç Vector Search with Qdrant
- üíæ Redis Caching for fast responses
- üåç Multilingual Support (Arabic & English)
- üìß Email Verification
- üîê Two-Factor Authentication
- üîó OAuth Social Login (Google)

================================================================================
                              AUTHENTICATION
================================================================================

The API uses Bearer token authentication. Protected endpoints require a valid JWT token.

HOW TO AUTHENTICATE:
1. Get a Token:
   - Login: POST /auth/login (with email/password)
   - OAuth: Use OAuth endpoints for social login

2. Use in Swagger UI:
   - Click the üîí Authorize button (top right)
   - Enter: Bearer YOUR_ACCESS_TOKEN
   - Click Authorize

3. Verify Authentication:
   - Use GET /auth/me to check if your token is valid

TOKEN MANAGEMENT:
- Tokens are automatically stored in browser localStorage
- Tokens expire after 30 minutes (configurable)
- Use refresh tokens to get new access tokens

================================================================================
                              API ENDPOINTS
================================================================================

1. AUTHENTICATION ENDPOINTS (/auth)
================================================================================

POST /auth/login
Description: User login with email and password
Authentication: None (public endpoint)
Request Body:
{
    "email": "user@example.com",
    "password": "SecurePassword123!",
    "remember_me": false,
    "two_factor_code": null
}

Response (200):
{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "full_name": "John Doe",
    "two_factor_required": false,
    "message": "Login successful"
}

Response (401):
{
    "error": "Invalid credentials",
    "message": "Email or password is incorrect",
    "status_code": 401
}

POST /auth/register
Description: User registration
Authentication: None (public endpoint)
Request Body:
{
    "email": "newuser@example.com",
    "password": "SecurePassword123!",
    "phone_number": "+1234567890",
    "first_name": "John",
    "last_name": "Doe"
}

Response (201):
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "newuser@example.com",
    "phone_number": "+1234567890",
    "full_name": "John Doe",
    "profile_picture": null,
    "oauth_provider": null,
    "status": "pending_verification",
    "is_email_verified": false,
    "is_phone_verified": false,
    "created_at": "2024-01-01T00:00:00Z",
    "registration_token": "verification_token_here",
    "message": "Registration successful. Please check your email for verification."
}

GET /auth/verify-email/{token}
Description: Verify email address
Authentication: None (public endpoint)
Parameters:
- token: Email verification token

Response (200):
{
    "message": "Email verified successfully",
    "verified": true,
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com"
}

GET /auth/oauth/providers
Description: Get available OAuth providers
Authentication: None (public endpoint)

Response (200):
{
    "providers": ["google"],
    "configured_providers": {
        "google": true
    }
}

POST /auth/oauth/{provider}/authorize
Description: Get OAuth authorization URL
Authentication: None (public endpoint)
Parameters:
- provider: OAuth provider (google)
- redirect_uri: Optional redirect URI

Request Body:
{
    "provider": "google",
    "redirect_uri": "http://localhost:9000/auth/oauth/google/callback"
}

Response (200):
{
    "authorization_url": "https://accounts.google.com/oauth/authorize?...",
    "redirect_uri": "http://localhost:9000/auth/oauth/google/callback",
    "state": "random_state_string",
    "provider": "google"
}

GET /auth/oauth/{provider}/callback
Description: OAuth callback endpoint
Authentication: None (public endpoint)
Parameters:
- provider: OAuth provider (google)
- code: Authorization code
- state: State parameter
- error: Error parameter (if any)

Response (200):
{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@gmail.com",
    "full_name": "John Doe",
    "two_factor_required": false,
    "message": "OAuth login successful"
}

POST /auth/oauth/{provider}/refresh
Description: Refresh OAuth token
Authentication: Required
Parameters:
- provider: OAuth provider (google)

Request Body:
{
    "email": "user@gmail.com",
    "provider": "google"
}

Response (200):
{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@gmail.com",
    "full_name": "John Doe",
    "message": "OAuth token refreshed successfully"
}

POST /auth/forgot-password
Description: Request password reset
Authentication: None (public endpoint)
Request Body:
{
    "email": "user@example.com"
}

Response (200):
{
    "msg": "ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿßÿ®ÿ∑ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿπŸäŸäŸÜ ÿ•ŸÑŸâ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä"
}

POST /auth/reset-password
Description: Reset password with token
Authentication: None (public endpoint)
Request Body:
{
    "token": "reset_token_here",
    "new_password": "NewSecurePassword123!",
    "confirm_password": "NewSecurePassword123!"
}

Response (200):
{
    "msg": "ÿ™ŸÖÿ™ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ®ŸÜÿ¨ÿßÿ≠ÿå Ÿàÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿÆÿ±Ÿàÿ¨ŸÉ ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ¨Ÿáÿ≤ÿ©"
}

POST /auth/2fa/setup
Description: Setup two-factor authentication
Authentication: Required

Response (200):
{
    "secret_key": "JBSWY3DPEHPK3PXP",
    "qr_code": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
}

POST /auth/2fa/verify
Description: Verify and enable 2FA
Authentication: Required
Request Body:
{
    "code": "123456"
}

Response (200):
{
    "status": "success",
    "message": "Two-factor authentication enabled successfully"
}

POST /auth/2fa/disable
Description: Disable two-factor authentication
Authentication: Required

Response (200):
{
    "status": "success",
    "message": "Two-factor authentication disabled successfully"
}

GET /auth/me
Description: Get current authenticated user information
Authentication: Required

Response (200):
{
    "authenticated": true,
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "full_name": "John Doe",
    "message": "Authentication successful! Your token is valid."
}

POST /auth/debug-token
Description: Debug token validation
Authentication: None (public endpoint)
Request Body:
{
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

Response (200):
{
    "valid": true,
    "user": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "email": "user@example.com",
        "full_name": "John Doe",
        "is_email_verified": true
    },
    "token_payload": {
        "sub": "user@example.com",
        "exp": 1704067200,
        "iat": 1704063600
    }
}

GET /auth/refresh-oauth/{email}
Description: Get OAuth refresh URL for a specific user
Authentication: None (public endpoint)
Parameters:
- email: User email address

Response (200):
{
    "user": {
        "email": "user@gmail.com",
        "full_name": "John Doe",
        "oauth_provider": "google"
    },
    "oauth_url": "https://accounts.google.com/oauth/authorize?...",
    "state": "random_state_string",
    "instructions": [
        "1. Click the oauth_url above",
        "2. Complete the OAuth flow",
        "3. You'll get a fresh token",
        "4. Use the new token in Swagger UI"
    ]
}

GET /auth/health
Description: Authentication service health check
Authentication: None (public endpoint)

Response (200):
{
    "status": "healthy",
    "service": "Authentication Service",
    "email_configured": true,
    "oauth_providers": ["google"],
    "database_connected": true,
    "version": "1.0.0"
}

================================================================================
2. QUESTIONS ENDPOINTS (/questions)
================================================================================

POST /questions/
Description: Create a new question
Authentication: Required
Request Body:
{
    "question": "What is the capital of Syria?"
}

Response (200):
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "question": "What is the capital of Syria?",
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
}

GET /questions/
Description: Get all questions
Authentication: Required

Response (200):
[
    {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "question": "What is the capital of Syria?",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    }
]

GET /questions/{question_id}
Description: Get question with answers
Authentication: Required
Parameters:
- question_id: UUID of the question

Response (200):
{
    "question": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "question": "What is the capital of Syria?",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "answers": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440001",
            "answer": "Damascus is the capital of Syria.",
            "question_id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "created_at": "2024-01-01T00:00:00Z",
            "author": "John Doe"
        }
    ]
}

DELETE /questions/{question_id}
Description: Delete a question
Authentication: Required
Parameters:
- question_id: UUID of the question

Response (200):
{
    "status": "success",
    "message": "Question deleted successfully"
}

================================================================================
3. ANSWERS ENDPOINTS (/answers)
================================================================================

POST /answers/
Description: Create a new answer
Authentication: Required
Request Body:
{
    "answer": "Damascus is the capital of Syria.",
    "question_id": "550e8400-e29b-41d4-a716-446655440000",
    "author": "John Doe"
}

Response (200):
{
    "id": "550e8400-e29b-41d4-a716-446655440001",
    "answer": "Damascus is the capital of Syria.",
    "question_id": "550e8400-e29b-41d4-a716-446655440000",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "created_at": "2024-01-01T00:00:00Z",
    "author": "John Doe"
}

GET /answers/question/{question_id}
Description: Get all answers for a specific question
Authentication: Required
Parameters:
- question_id: UUID of the question

Response (200):
[
    {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "answer": "Damascus is the capital of Syria.",
        "question_id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "created_at": "2024-01-01T00:00:00Z",
        "author": "John Doe"
    }
]

GET /answers/{answer_id}
Description: Get answer by ID
Authentication: Required
Parameters:
- answer_id: UUID of the answer

Response (200):
{
    "id": "550e8400-e29b-41d4-a716-446655440001",
    "answer": "Damascus is the capital of Syria.",
    "question_id": "550e8400-e29b-41d4-a716-446655440000",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "created_at": "2024-01-01T00:00:00Z",
    "author": "John Doe"
}

DELETE /answers/{answer_id}
Description: Delete an answer
Authentication: Required
Parameters:
- answer_id: UUID of the answer

Response (200):
{
    "status": "success",
    "message": "Answer deleted successfully"
}

================================================================================
4. INTELLIGENT Q&A ENDPOINTS (/intelligent-qa)
================================================================================

POST /intelligent-qa/ask
Description: Ask an intelligent question using AI
Authentication: Required
Query Parameters:
- question: The question to ask (required)
- user_id: Optional user ID
- context: Optional additional context
- language: Preferred response language (en, ar, auto) - default: auto

Example Request:
POST /intelligent-qa/ask?question=What%20is%20the%20history%20of%20Damascus?&language=en

Response (200):
{
    "status": "success",
    "data": {
        "answer": "Damascus is one of the oldest continuously inhabited cities in the world...",
        "confidence": 0.95,
        "source": "vector_search",
        "processing_info": {
            "embedding_generated": true,
            "vector_search_performed": true,
            "web_content_fetched": false,
            "gemini_api_used": false,
            "cache_hit": true,
            "processing_time_ms": 150
        },
        "metadata": {
            "question_id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "language": "en",
            "timestamp": "2024-01-01T00:00:00Z"
        }
    },
    "message": "Question processed successfully"
}

Response (400):
{
    "detail": "Question cannot be empty"
}

Response (503):
{
    "detail": "An internal server error occurred. Please try again later."
}

GET /intelligent-qa/similar-questions
Description: Find similar questions using semantic search
Authentication: Required
Query Parameters:
- question: The question to find similar ones for (required)
- limit: Maximum number of similar questions to return (default: 5)

Example Request:
GET /intelligent-qa/similar-questions?question=What%20is%20the%20capital%20of%20Syria?&limit=3

Response (200):
{
    "status": "success",
    "data": {
        "similar_questions": [
            {
                "question": "What is the capital city of Syria?",
                "similarity_score": 0.95,
                "answer": "Damascus is the capital of Syria."
            },
            {
                "question": "Which city is the capital of Syria?",
                "similarity_score": 0.92,
                "answer": "Damascus serves as the capital of Syria."
            }
        ],
        "count": 2,
        "original_question": "What is the capital of Syria?"
    },
    "message": "Found 2 similar questions"
}

POST /intelligent-qa/augment-variants
Description: Generate and store question variants
Authentication: Required
Query Parameters:
- question: The original question (required)
- answer: The answer to the question (required)

Example Request:
POST /intelligent-qa/augment-variants?question=What%20is%20the%20capital%20of%20Syria?&answer=Damascus%20is%20the%20capital%20of%20Syria.

Response (200):
{
    "status": "success",
    "data": {
        "original_question": "What is the capital of Syria?",
        "variants": [
            "What is the capital city of Syria?",
            "Which city is the capital of Syria?",
            "What is Syria's capital?",
            "Name the capital of Syria"
        ],
        "count": 4
    },
    "message": "Generated 4 question variants"
}

GET /intelligent-qa/health
Description: Enhanced system health check
Authentication: Required

Response (200):
{
    "status": "healthy",
    "components": {
        "qdrant": {
            "status": "healthy",
            "response_time_ms": 50,
            "collections_count": 5
        },
        "embedding": {
            "status": "healthy",
            "model": "text-embedding-ada-002",
            "response_time_ms": 200
        },
        "gemini": {
            "status": "healthy",
            "model": "gemini-pro",
            "response_time_ms": 1500
        },
        "web_scraping": {
            "status": "healthy",
            "sources_count": 3,
            "last_fetch": "2024-01-01T00:00:00Z"
        }
    },
    "healthy_components": "4/4",
    "initialized": true,
    "recommendations": [
        "All systems are healthy and operating normally."
    ]
}

POST /intelligent-qa/initialize
Description: Initialize the enhanced Syria GPT Q&A system
Authentication: Required

Response (200):
{
    "status": "success",
    "data": {
        "qdrant_initialized": true,
        "knowledge_base_loaded": true,
        "web_scraping_configured": true,
        "total_vectors": 15000,
        "collections_created": 5
    },
    "message": "Enhanced Syria GPT Q&A system initialized successfully"
}

GET /intelligent-qa/web-scraping-status
Description: Get web scraping service status
Authentication: Required

Response (200):
{
    "status": "success",
    "data": {
        "service_status": "active",
        "recent_articles_count": 5,
        "sources": ["news_source_1", "news_source_2", "news_source_3"],
        "last_fetch": "recent"
    },
    "message": "Web scraping service is active with 5 recent articles"
}

================================================================================
5. SMTP CONFIGURATION ENDPOINTS (/smtp)
================================================================================

GET /smtp/providers
Description: Get all available SMTP providers
Authentication: None (public endpoint)

Response (200):
{
    "providers": {
        "gmail": {
            "name": "Gmail",
            "instructions": "Enable 2-factor authentication and generate an app password",
            "setup_url": "https://myaccount.google.com/apppasswords",
            "app_password_required": true
        },
        "hotmail": {
            "name": "Hotmail/Outlook",
            "instructions": "Use your regular password or generate an app password",
            "setup_url": "https://account.live.com/proofs/AppPassword",
            "app_password_required": false
        }
    },
    "supported_domains": {
        "gmail.com": "gmail",
        "googlemail.com": "gmail",
        "hotmail.com": "hotmail",
        "outlook.com": "hotmail"
    }
}

GET /smtp/providers/{provider}
Description: Get detailed information about a specific SMTP provider
Authentication: None (public endpoint)
Parameters:
- provider: The provider key (e.g., 'gmail', 'hotmail', 'outlook')

Response (200):
{
    "name": "Gmail",
    "instructions": "Enable 2-factor authentication and generate an app password",
    "setup_url": "https://myaccount.google.com/apppasswords",
    "app_password_required": true
}

POST /smtp/test
Description: Test SMTP connection with provided credentials
Authentication: None (public endpoint)
Request Body:
{
    "email": "user@gmail.com",
    "password": "app_password_here",
    "provider": "gmail"
}

Response (200):
{
    "success": true,
    "message": "SMTP connection test successful",
    "provider_detected": "gmail",
    "provider_info": {
        "name": "Gmail",
        "instructions": "Enable 2-factor authentication and generate an app password",
        "setup_url": "https://myaccount.google.com/apppasswords",
        "app_password_required": true
    }
}

Response (400):
{
    "success": false,
    "message": "Invalid email format"
}

POST /smtp/detect-provider
Description: Detect the SMTP provider from an email address
Authentication: None (public endpoint)
Request Body:
{
    "email": "user@gmail.com"
}

Response (200):
{
    "success": true,
    "message": "Provider detected: gmail",
    "provider_detected": "gmail",
    "provider_info": {
        "name": "Gmail",
        "instructions": "Enable 2-factor authentication and generate an app password",
        "setup_url": "https://myaccount.google.com/apppasswords",
        "app_password_required": true
    }
}

GET /smtp/supported-domains
Description: Get list of supported email domains
Authentication: None (public endpoint)

Response (200):
{
    "supported_domains": {
        "gmail.com": "gmail",
        "googlemail.com": "gmail",
        "hotmail.com": "hotmail",
        "outlook.com": "hotmail",
        "yahoo.com": "yahoo"
    },
    "total_domains": 5
}

POST /smtp/configure
Description: Configure SMTP settings for the application
Authentication: None (public endpoint)
Request Body:
{
    "email": "user@gmail.com",
    "password": "app_password_here",
    "provider": "gmail",
    "use_ssl": true,
    "custom_host": null,
    "custom_port": null
}

Response (200):
{
    "success": true,
    "message": "SMTP configuration for Gmail",
    "provider": "gmail",
    "host": "smtp.gmail.com",
    "port": 465,
    "use_ssl": true,
    "use_tls": false
}

GET /smtp/health
Description: Check SMTP service health and configuration status
Authentication: None (public endpoint)

Response (200):
{
    "status": "healthy",
    "service": "SMTP Configuration",
    "configured": true,
    "available_providers": 5,
    "supported_domains": 15,
    "providers": ["gmail", "hotmail", "outlook", "yahoo", "protonmail"],
    "message": "SMTP configuration service is operational"
}

================================================================================
6. USER MANAGEMENT ENDPOINTS (/users)
================================================================================

GET /users/
Description: Search and filter users with pagination
Authentication: Required (Admin privileges)
Query Parameters:
- email: Filter by email
- phone_number: Filter by phone number
- status: Filter by status (active, suspended, banned, pending_verification)
- oauth_provider: Filter by OAuth provider
- is_email_verified: Filter by email verification status
- is_phone_verified: Filter by phone verification status
- two_factor_enabled: Filter by 2FA status
- created_after: Filter by creation date (after)
- created_before: Filter by creation date (before)
- page: Page number (default: 1)
- page_size: Page size (default: 10, max: 100)

Response (200):
{
    "users": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440000",
            "email": "user@example.com",
            "phone_number": "+1234567890",
            "first_name": "John",
            "last_name": "Doe",
            "full_name": "John Doe",
            "profile_picture": null,
            "oauth_provider": null,
            "oauth_provider_id": null,
            "two_factor_enabled": false,
            "is_email_verified": true,
            "is_phone_verified": false,
            "status": "active",
            "last_login_at": "2024-01-01T00:00:00Z",
            "created_at": "2024-01-01T00:00:00Z",
            "updated_at": "2024-01-01T00:00:00Z"
        }
    ],
    "total_count": 1,
    "page": 1,
    "page_size": 10,
    "total_pages": 1
}

GET /users/stats
Description: Get comprehensive user statistics
Authentication: Required (Admin privileges)

Response (200):
{
    "total_users": 100,
    "active_users": 85,
    "suspended_users": 5,
    "banned_users": 2,
    "pending_verification": 8,
    "email_verified_users": 92,
    "phone_verified_users": 45,
    "oauth_users": 30,
    "two_factor_enabled_users": 15,
    "users_created_today": 5,
    "users_created_this_week": 25,
    "users_created_this_month": 100
}

GET /users/{user_id}
Description: Get user by ID
Authentication: Required (Own profile or Admin privileges)
Parameters:
- user_id: UUID of the user

Response (200):
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "phone_number": "+1234567890",
    "first_name": "John",
    "last_name": "Doe",
    "full_name": "John Doe",
    "profile_picture": null,
    "oauth_provider": null,
    "oauth_provider_id": null,
    "two_factor_enabled": false,
    "is_email_verified": true,
    "is_phone_verified": false,
    "status": "active",
    "last_login_at": "2024-01-01T00:00:00Z",
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
}

GET /users/{user_id}/detail
Description: Get detailed user information including session stats
Authentication: Required (Own profile or Admin privileges)
Parameters:
- user_id: UUID of the user

Response (200):
{
    "user": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "email": "user@example.com",
        "phone_number": "+1234567890",
        "first_name": "John",
        "last_name": "Doe",
        "full_name": "John Doe",
        "profile_picture": null,
        "oauth_provider": null,
        "oauth_provider_id": null,
        "two_factor_enabled": false,
        "is_email_verified": true,
        "is_phone_verified": false,
        "status": "active",
        "last_login_at": "2024-01-01T00:00:00Z",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "active_sessions_count": 2,
    "total_sessions_count": 15,
    "last_activity": "2024-01-01T00:00:00Z",
    "settings": {
        "email_notifications": true,
        "sms_notifications": false,
        "two_factor_enabled": false,
        "session_timeout_hours": 24,
        "max_concurrent_sessions": 5,
        "language": "en",
        "timezone": "UTC",
        "theme": "light"
    }
}

PUT /users/{user_id}
Description: Update user information
Authentication: Required (Own profile or Admin privileges)
Parameters:
- user_id: UUID of the user

Request Body:
{
    "first_name": "John",
    "last_name": "Smith",
    "phone_number": "+1234567890",
    "profile_picture": "https://example.com/avatar.jpg"
}

Response (200):
{
    "user": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "email": "user@example.com",
        "phone_number": "+1234567890",
        "first_name": "John",
        "last_name": "Smith",
        "full_name": "John Smith",
        "profile_picture": "https://example.com/avatar.jpg",
        "oauth_provider": null,
        "oauth_provider_id": null,
        "two_factor_enabled": false,
        "is_email_verified": true,
        "is_phone_verified": false,
        "status": "active",
        "last_login_at": "2024-01-01T00:00:00Z",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "User updated successfully"
}

POST /users/{user_id}/change-password
Description: Change user password
Authentication: Required (Own profile only)
Parameters:
- user_id: UUID of the user

Request Body:
{
    "current_password": "OldPassword123!",
    "new_password": "NewPassword123!",
    "confirm_password": "NewPassword123!"
}

Response (200):
{
    "message": "Password changed successfully",
    "password_changed_at": "2024-01-01T00:00:00Z"
}

PUT /users/{user_id}/status
Description: Update user status (Admin only)
Authentication: Required (Admin privileges)
Parameters:
- user_id: UUID of the user

Request Body:
{
    "status": "suspended"
}

Response (200):
{
    "user": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "email": "user@example.com",
        "status": "suspended",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "User status updated successfully"
}

POST /users/bulk-action
Description: Perform bulk actions on users (Admin only)
Authentication: Required (Admin privileges)

Request Body:
{
    "user_ids": ["550e8400-e29b-41d4-a716-446655440000", "550e8400-e29b-41d4-a716-446655440001"],
    "action": "activate"
}

Response (200):
{
    "success_count": 2,
    "failed_count": 0,
    "failed_users": [],
    "message": "Successfully activated 2 users"
}

GET /users/{user_id}/settings
Description: Get user settings
Authentication: Required (Own profile only)
Parameters:
- user_id: UUID of the user

Response (200):
{
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email_notifications": true,
    "sms_notifications": false,
    "two_factor_enabled": false,
    "session_timeout_hours": 24,
    "max_concurrent_sessions": 5,
    "language": "en",
    "timezone": "UTC",
    "theme": "light",
    "updated_at": "2024-01-01T00:00:00Z"
}

PUT /users/{user_id}/settings
Description: Update user settings
Authentication: Required (Own profile only)
Parameters:
- user_id: UUID of the user

Request Body:
{
    "email_notifications": true,
    "sms_notifications": false,
    "two_factor_enabled": true,
    "session_timeout_hours": 48,
    "max_concurrent_sessions": 3,
    "language": "ar",
    "timezone": "Asia/Damascus",
    "theme": "dark"
}

Response (200):
{
    "settings": {
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "email_notifications": true,
        "sms_notifications": false,
        "two_factor_enabled": true,
        "session_timeout_hours": 48,
        "max_concurrent_sessions": 3,
        "language": "ar",
        "timezone": "Asia/Damascus",
        "theme": "dark",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "Settings updated successfully"
}

GET /users/me/profile
Description: Get current user's profile
Authentication: Required

Response (200):
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "phone_number": "+1234567890",
    "first_name": "John",
    "last_name": "Doe",
    "full_name": "John Doe",
    "profile_picture": null,
    "oauth_provider": null,
    "oauth_provider_id": null,
    "two_factor_enabled": false,
    "is_email_verified": true,
    "is_phone_verified": false,
    "status": "active",
    "last_login_at": "2024-01-01T00:00:00Z",
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
}

PUT /users/me/profile
Description: Update current user's profile
Authentication: Required

Request Body:
{
    "first_name": "John",
    "last_name": "Smith",
    "phone_number": "+1234567890",
    "profile_picture": "https://example.com/avatar.jpg"
}

Response (200):
{
    "user": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "email": "user@example.com",
        "phone_number": "+1234567890",
        "first_name": "John",
        "last_name": "Smith",
        "full_name": "John Smith",
        "profile_picture": "https://example.com/avatar.jpg",
        "oauth_provider": null,
        "oauth_provider_id": null,
        "two_factor_enabled": false,
        "is_email_verified": true,
        "is_phone_verified": false,
        "status": "active",
        "last_login_at": "2024-01-01T00:00:00Z",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "User updated successfully"
}

GET /users/me/settings
Description: Get current user's settings
Authentication: Required

Response (200):
{
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email_notifications": true,
    "sms_notifications": false,
    "two_factor_enabled": false,
    "session_timeout_hours": 24,
    "max_concurrent_sessions": 5,
    "language": "en",
    "timezone": "UTC",
    "theme": "light",
    "updated_at": "2024-01-01T00:00:00Z"
}

PUT /users/me/settings
Description: Update current user's settings
Authentication: Required

Request Body:
{
    "email_notifications": true,
    "sms_notifications": false,
    "two_factor_enabled": true,
    "session_timeout_hours": 48,
    "max_concurrent_sessions": 3,
    "language": "ar",
    "timezone": "Asia/Damascus",
    "theme": "dark"
}

Response (200):
{
    "settings": {
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "email_notifications": true,
        "sms_notifications": false,
        "two_factor_enabled": true,
        "session_timeout_hours": 48,
        "max_concurrent_sessions": 3,
        "language": "ar",
        "timezone": "Asia/Damascus",
        "theme": "dark",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "Settings updated successfully"
}

================================================================================
7. SESSION MANAGEMENT ENDPOINTS (/sessions)
================================================================================

GET /sessions/
Description: Search and filter sessions with pagination
Authentication: Required (Admin privileges)
Query Parameters:
- user_id: Filter by user ID
- is_active: Filter by active status
- is_mobile: Filter by mobile status
- ip_address: Filter by IP address
- created_after: Filter by creation date (after)
- created_before: Filter by creation date (before)
- expires_after: Filter by expiry date (after)
- expires_before: Filter by expiry date (before)
- page: Page number (default: 1)
- page_size: Page size (default: 10, max: 100)

Response (200):
{
    "sessions": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "session_token": "session_token_here",
            "device_info": "Chrome 120.0.0.0 on Windows",
            "ip_address": "192.168.1.1",
            "user_agent": "Mozilla/5.0...",
            "location": "Damascus, Syria",
            "is_active": true,
            "is_mobile": false,
            "last_activity_at": "2024-01-01T00:00:00Z",
            "expires_at": "2024-01-02T00:00:00Z",
            "created_at": "2024-01-01T00:00:00Z",
            "updated_at": "2024-01-01T00:00:00Z"
        }
    ],
    "total_count": 1,
    "page": 1,
    "page_size": 10,
    "total_pages": 1
}

GET /sessions/stats
Description: Get comprehensive session statistics
Authentication: Required (Admin privileges)

Response (200):
{
    "total_sessions": 150,
    "active_sessions": 85,
    "expired_sessions": 65,
    "mobile_sessions": 30,
    "desktop_sessions": 120,
    "sessions_created_today": 15,
    "sessions_created_this_week": 75,
    "average_session_duration_hours": 12.5
}

GET /sessions/{session_id}
Description: Get session by ID
Authentication: Required (Own session or Admin privileges)
Parameters:
- session_id: UUID of the session

Response (200):
{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "session_token": "session_token_here",
    "device_info": "Chrome 120.0.0.0 on Windows",
    "ip_address": "192.168.1.1",
    "user_agent": "Mozilla/5.0...",
    "location": "Damascus, Syria",
    "is_active": true,
    "is_mobile": false,
    "last_activity_at": "2024-01-01T00:00:00Z",
    "expires_at": "2024-01-02T00:00:00Z",
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
}

POST /sessions/
Description: Create a new session for the current user
Authentication: Required

Request Body:
{
    "device_info": "Chrome 120.0.0.0 on Windows",
    "ip_address": "192.168.1.1",
    "user_agent": "Mozilla/5.0...",
    "location": "Damascus, Syria",
    "is_mobile": false,
    "expires_in_hours": 24
}

Response (200):
{
    "session": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "session_token": "session_token_here",
        "device_info": "Chrome 120.0.0.0 on Windows",
        "ip_address": "192.168.1.1",
        "user_agent": "Mozilla/5.0...",
        "location": "Damascus, Syria",
        "is_active": true,
        "is_mobile": false,
        "last_activity_at": "2024-01-01T00:00:00Z",
        "expires_at": "2024-01-02T00:00:00Z",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "refresh_token_here",
    "message": "Session created successfully"
}

DELETE /sessions/{session_id}
Description: Revoke a session
Authentication: Required (Own session or Admin privileges)
Parameters:
- session_id: UUID of the session

Response (200):
{
    "message": "Session revoked successfully"
}

GET /sessions/me/active
Description: Get current user's active sessions
Authentication: Required

Response (200):
{
    "sessions": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "session_token": "session_token_here",
            "device_info": "Chrome 120.0.0.0 on Windows",
            "ip_address": "192.168.1.1",
            "user_agent": "Mozilla/5.0...",
            "location": "Damascus, Syria",
            "is_active": true,
            "is_mobile": false,
            "last_activity_at": "2024-01-01T00:00:00Z",
            "expires_at": "2024-01-02T00:00:00Z",
            "created_at": "2024-01-01T00:00:00Z",
            "updated_at": "2024-01-01T00:00:00Z"
        }
    ],
    "total_count": 1,
    "page": 1,
    "page_size": 10,
    "total_pages": 1
}

DELETE /sessions/me/all
Description: Revoke all active sessions for the current user
Authentication: Required

Response (200):
{
    "message": "Revoked 3 sessions",
    "revoked_count": 3
}

================================================================================
8. SYSTEM ENDPOINTS
================================================================================

GET /
Description: Root endpoint - Welcome message
Authentication: None (public endpoint)

Response (200):
{
    "message": "Welcome to Syria GPT!",
    "version": "1.0.0",
    "ai_provider": "Google Gemini",
    "features": [
        "Intelligent Q&A",
        "Vector Search",
        "Redis Caching",
        "Multilingual Support"
    ]
}

GET /hello/{name}
Description: Greeting endpoint
Authentication: None (public endpoint)
Parameters:
- name: Name to greet

Response (200):
{
    "message": "Hello, John! Welcome to Syria GPT."
}

GET /test/health
Description: System health check
Authentication: None (public endpoint)

Response (200):
{
    "status": "healthy",
    "service": "Syria GPT API",
    "version": "1.0.0",
    "timestamp": "2024-01-01T00:00:00Z"
}

================================================================================
                              DATA MODELS
================================================================================

REQUEST MODELS
=============

UserRegistrationRequest:
{
    "email": "string (email)",
    "password": "string (min: 8 chars, must contain uppercase, lowercase, number, special char)",
    "phone_number": "string (optional, phone format)",
    "first_name": "string (optional, max: 100)",
    "last_name": "string (optional, max: 100)"
}

UserLoginRequest:
{
    "email": "string (email)",
    "password": "string",
    "remember_me": "boolean (optional, default: false)",
    "two_factor_code": "string (optional, 6 digits)"
}

QuestionCreateRequest:
{
    "question": "string (min: 1, max: 10000)"
}

AnswerCreateRequest:
{
    "answer": "string (min: 1, max: 10000)",
    "question_id": "string (UUID)",
    "author": "string (min: 1, max: 255)"
}

UserUpdateRequest:
{
    "first_name": "string (optional, max: 100)",
    "last_name": "string (optional, max: 100)",
    "phone_number": "string (optional, phone format)",
    "profile_picture": "string (optional, max: 500)"
}

UserPasswordChangeRequest:
{
    "current_password": "string",
    "new_password": "string (min: 8 chars, must contain uppercase, lowercase, number, special char)",
    "confirm_password": "string (must match new_password)"
}

UserSettingsRequest:
{
    "email_notifications": "boolean (optional, default: true)",
    "sms_notifications": "boolean (optional, default: false)",
    "two_factor_enabled": "boolean (optional, default: false)",
    "session_timeout_hours": "integer (optional, default: 24, range: 1-720)",
    "max_concurrent_sessions": "integer (optional, default: 5, range: 1-20)",
    "language": "string (optional, default: 'en', enum: ['en', 'ar'])",
    "timezone": "string (optional, default: 'UTC', max: 50)",
    "theme": "string (optional, default: 'light', enum: ['light', 'dark', 'auto'])"
}

SessionCreateRequest:
{
    "device_info": "string (optional)",
    "ip_address": "string (optional)",
    "user_agent": "string (optional)",
    "location": "string (optional)",
    "is_mobile": "boolean (optional, default: false)",
    "expires_in_hours": "integer (optional, default: 24, range: 1-720)"
}

SMTPTestRequest:
{
    "email": "string (email)",
    "password": "string",
    "provider": "string (optional)"
}

ChatCreateRequest:
{
    "title": "string (optional, max: 255)",
    "description": "string (optional, max: 1000)",
    "context": "string (optional, max: 5000)",
    "language": "string (default: 'auto', enum: ['auto', 'en', 'ar'])",
    "model_preference": "string (optional, default: 'gemini-1.5-flash', enum: ['gemini-1.5-flash', 'gemini-1.5-pro', 'gemini-2.0-flash'])",
    "max_tokens": "integer (optional, default: 2000, range: 100-8000)",
    "temperature": "float (optional, default: 0.7, range: 0.0-2.0)"
}

ChatMessageRequest:
{
    "message": "string (min: 1, max: 10000)",
    "message_type": "string (default: 'text', enum: ['text', 'image', 'file', 'voice'])",
    "attachments": "array of strings (optional, max: 5 items)",
    "context": "string (optional, max: 2000)",
    "language": "string (optional, enum: ['auto', 'en', 'ar'])",
    "priority": "string (default: 'normal', enum: ['low', 'normal', 'high', 'urgent'])"
}

ChatUpdateRequest:
{
    "title": "string (optional, max: 255)",
    "description": "string (optional, max: 1000)",
    "context": "string (optional, max: 5000)",
    "language": "string (optional, enum: ['auto', 'en', 'ar'])",
    "model_preference": "string (optional, enum: ['gemini-1.5-flash', 'gemini-1.5-pro', 'gemini-2.0-flash'])",
    "max_tokens": "integer (optional, range: 100-8000)",
    "temperature": "float (optional, range: 0.0-2.0)",
    "is_archived": "boolean (optional)",
    "is_pinned": "boolean (optional)"
}

ChatBulkActionRequest:
{
    "chat_ids": "array of strings (min: 1 item)",
    "action": "string (enum: ['archive', 'unarchive', 'pin', 'unpin', 'delete', 'export'])"
}

ChatExportRequest:
{
    "format": "string (default: 'json', enum: ['json', 'csv', 'txt', 'pdf'])",
    "include_metadata": "boolean (default: true)",
    "include_context": "boolean (default: true)",
    "include_attachments": "boolean (default: false)",
    "date_range_start": "datetime (optional)",
    "date_range_end": "datetime (optional)"
}

ChatFeedbackRequest:
{
    "rating": "integer (range: 1-5)",
    "feedback_type": "string (enum: ['helpful', 'unhelpful', 'inaccurate', 'inappropriate', 'other'])",
    "comment": "string (optional, max: 1000)",
    "category": "string (optional, enum: ['accuracy', 'relevance', 'completeness', 'clarity', 'speed', 'other'])"
}

ChatSettingsRequest:
{
    "default_language": "string (default: 'auto', enum: ['auto', 'en', 'ar'])",
    "default_model": "string (default: 'gemini-1.5-flash', enum: ['gemini-1.5-flash', 'gemini-1.5-pro', 'gemini-2.0-flash'])",
    "default_max_tokens": "integer (default: 2000, range: 100-8000)",
    "default_temperature": "float (default: 0.7, range: 0.0-2.0)",
    "auto_archive_after_days": "integer (default: 30, range: 1-365)",
    "max_chats_per_user": "integer (default: 100, range: 1-1000)",
    "max_messages_per_chat": "integer (default: 1000, range: 10-10000)",
    "enable_voice_input": "boolean (default: true)",
    "enable_file_upload": "boolean (default: true)",
    "enable_image_analysis": "boolean (default: true)",
    "enable_context_memory": "boolean (default: true)",
    "enable_chat_history": "boolean (default: true)",
    "enable_analytics": "boolean (default: true)",
    "enable_feedback": "boolean (default: true)"
}

RESPONSE MODELS
==============

LoginResponse:
{
    "access_token": "string (optional)",
    "token_type": "string (default: 'bearer')",
    "user_id": "string (UUID)",
    "email": "string",
    "full_name": "string (optional)",
    "two_factor_required": "boolean (default: false)",
    "message": "string (optional)"
}

UserResponse:
{
    "id": "string (UUID)",
    "email": "string",
    "phone_number": "string (optional)",
    "first_name": "string (optional)",
    "last_name": "string (optional)",
    "full_name": "string (optional)",
    "profile_picture": "string (optional)",
    "oauth_provider": "string (optional)",
    "oauth_provider_id": "string (optional)",
    "two_factor_enabled": "boolean",
    "is_email_verified": "boolean",
    "is_phone_verified": "boolean",
    "status": "string (enum: ['active', 'suspended', 'banned', 'pending_verification'])",
    "last_login_at": "datetime (optional)",
    "created_at": "datetime",
    "updated_at": "datetime"
}

QuestionResponse:
{
    "id": "string (UUID)",
    "user_id": "string (UUID)",
    "question": "string",
    "created_at": "datetime",
    "updated_at": "datetime"
}

AnswerResponse:
{
    "id": "string (UUID)",
    "answer": "string",
    "question_id": "string (UUID)",
    "user_id": "string (UUID)",
    "created_at": "datetime",
    "author": "string"
}

SessionResponse:
{
    "id": "string (UUID)",
    "user_id": "string (UUID)",
    "session_token": "string",
    "device_info": "string (optional)",
    "ip_address": "string (optional)",
    "user_agent": "string (optional)",
    "location": "string (optional)",
    "is_active": "boolean",
    "is_mobile": "boolean",
    "last_activity_at": "datetime",
    "expires_at": "datetime",
    "created_at": "datetime",
    "updated_at": "datetime"
}

GeneralResponse:
{
    "status": "string (enum: ['success', 'error'])",
    "message": "string"
}

ChatResponse:
{
    "id": "string (UUID)",
    "user_id": "string (UUID)",
    "title": "string (optional)",
    "description": "string (optional)",
    "context": "string (optional)",
    "language": "string",
    "model_preference": "string",
    "max_tokens": "integer",
    "temperature": "float",
    "message_count": "integer",
    "is_archived": "boolean",
    "is_pinned": "boolean",
    "last_message_at": "datetime (optional)",
    "created_at": "datetime",
    "updated_at": "datetime"
}

ChatMessageResponse:
{
    "id": "string (UUID)",
    "chat_id": "string (UUID)",
    "user_id": "string (UUID)",
    "message": "string",
    "message_type": "string",
    "attachments": "array of strings (optional)",
    "context": "string (optional)",
    "language": "string",
    "priority": "string",
    "is_ai_response": "boolean",
    "ai_model_used": "string (optional)",
    "processing_time_ms": "integer (optional)",
    "confidence_score": "float (optional)",
    "feedback_rating": "integer (optional)",
    "feedback_comment": "string (optional)",
    "created_at": "datetime"
}

ChatDetailResponse:
{
    "chat": "ChatResponse object",
    "messages": "array of ChatMessageResponse objects",
    "user": "UserResponse object (optional)",
    "analytics": "object (optional)"
}

ChatListResponse:
{
    "chats": "array of ChatResponse objects",
    "total_count": "integer",
    "page": "integer",
    "page_size": "integer",
    "total_pages": "integer"
}

ChatCreateResponse:
{
    "chat": "ChatResponse object",
    "message": "string"
}

ChatUpdateResponse:
{
    "chat": "ChatResponse object",
    "message": "string"
}

ChatMessageCreateResponse:
{
    "message": "ChatMessageResponse object",
    "ai_response": "ChatMessageResponse object (optional)",
    "processing_time_ms": "integer",
    "message": "string"
}

ChatBulkActionResponse:
{
    "success_count": "integer",
    "failed_count": "integer",
    "failed_chats": "array of objects",
    "message": "string"
}

ChatExportResponse:
{
    "export_id": "string (UUID)",
    "format": "string",
    "download_url": "string (optional)",
    "file_size_bytes": "integer (optional)",
    "expires_at": "datetime",
    "message": "string"
}

ChatAnalyticsResponse:
{
    "total_chats": "integer",
    "total_messages": "integer",
    "ai_responses": "integer",
    "average_response_time_ms": "float",
    "user_satisfaction_score": "float",
    "most_used_language": "string",
    "most_used_model": "string",
    "daily_stats": "array of objects",
    "weekly_stats": "array of objects",
    "monthly_stats": "array of objects"
}

ChatFeedbackResponse:
{
    "message_id": "string (UUID)",
    "rating": "integer",
    "feedback_type": "string",
    "comment": "string (optional)",
    "category": "string (optional)",
    "created_at": "datetime",
    "message": "string"
}

ChatSettingsResponse:
{
    "user_id": "string (UUID)",
    "default_language": "string",
    "default_model": "string",
    "default_max_tokens": "integer",
    "default_temperature": "float",
    "auto_archive_after_days": "integer",
    "max_chats_per_user": "integer",
    "max_messages_per_chat": "integer",
    "enable_voice_input": "boolean",
    "enable_file_upload": "boolean",
    "enable_image_analysis": "boolean",
    "enable_context_memory": "boolean",
    "enable_chat_history": "boolean",
    "enable_analytics": "boolean",
    "enable_feedback": "boolean",
    "updated_at": "datetime"
}

ChatStatsResponse:
{
    "total_chats": "integer",
    "active_chats": "integer",
    "archived_chats": "integer",
    "pinned_chats": "integer",
    "total_messages": "integer",
    "ai_responses": "integer",
    "average_messages_per_chat": "float",
    "average_response_time_ms": "float",
    "chats_created_today": "integer",
    "chats_created_this_week": "integer",
    "chats_created_this_month": "integer",
    "most_active_hour": "integer",
    "most_used_language": "string",
    "most_used_model": "string"
}

================================================================================
                              ERROR CODES
================================================================================

HTTP Status Codes:
- 200: Success
- 201: Created
- 400: Bad Request - Invalid input data
- 401: Unauthorized - Authentication required
- 403: Forbidden - Insufficient permissions
- 404: Not Found - Resource not found
- 429: Too Many Requests - Rate limit exceeded
- 500: Internal Server Error - Server error
- 503: Service Unavailable - Service temporarily unavailable

Common Error Responses:
{
    "error": "string",
    "message": "string",
    "details": "object (optional)",
    "status_code": "integer"
}

================================================================================
                              RATE LIMITING
================================================================================

The API implements rate limiting to prevent abuse:

- Authentication endpoints: 5 requests per minute
- Intelligent Q&A endpoints: 10 requests per minute
- General endpoints: 100 requests per minute
- Admin endpoints: 50 requests per minute

Rate limit headers:
- X-RateLimit-Limit: Maximum requests per window
- X-RateLimit-Remaining: Remaining requests in current window
- X-RateLimit-Reset: Time when the rate limit resets

When rate limit is exceeded:
{
    "detail": "Rate limit exceeded: 5 per 1 minute"
}

================================================================================
                              SECURITY
================================================================================

Authentication:
- JWT Bearer tokens for API access
- Token expiration: 30 minutes (configurable)
- Refresh tokens for extended sessions
- OAuth 2.0 support for Google login

Password Requirements:
- Minimum 8 characters
- At least one uppercase letter
- At least one lowercase letter
- At least one number
- At least one special character

Two-Factor Authentication:
- TOTP (Time-based One-Time Password)
- QR code generation for authenticator apps
- 6-digit verification codes

Data Protection:
- All passwords are hashed using bcrypt
- Sensitive data is encrypted at rest
- HTTPS required for all communications
- Input validation and sanitization

================================================================================
                              EXAMPLES
================================================================================

COMPLETE AUTHENTICATION FLOW:
============================

1. Register a new user:
POST /auth/register
{
    "email": "newuser@example.com",
    "password": "SecurePassword123!",
    "phone_number": "+1234567890",
    "first_name": "John",
    "last_name": "Doe"
}

2. Verify email:
GET /auth/verify-email/{token}

3. Login:
POST /auth/login
{
    "email": "newuser@example.com",
    "password": "SecurePassword123!"
}

4. Use the access token:
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

INTELLIGENT Q&A EXAMPLE:
=======================

1. Ask a question:
POST /intelligent-qa/ask?question=What%20is%20the%20history%20of%20Damascus?&language=en

2. Find similar questions:
GET /intelligent-qa/similar-questions?question=What%20is%20the%20capital%20of%20Syria?&limit=3

3. Generate question variants:
POST /intelligent-qa/augment-variants?question=What%20is%20the%20capital%20of%20Syria?&answer=Damascus%20is%20the%20capital%20of%20Syria.

USER MANAGEMENT EXAMPLE:
=======================

1. Get user profile:
GET /users/me/profile

2. Update profile:
PUT /users/me/profile
{
    "first_name": "John",
    "last_name": "Smith",
    "phone_number": "+1234567890"
}

3. Change password:
POST /users/me/change-password
{
    "current_password": "OldPassword123!",
    "new_password": "NewPassword123!",
    "confirm_password": "NewPassword123!"
}

SESSION MANAGEMENT EXAMPLE:
==========================

1. Get active sessions:
GET /sessions/me/active

2. Create new session:
POST /sessions/
{
    "device_info": "Chrome on Windows",
    "ip_address": "192.168.1.1",
    "expires_in_hours": 48
}

3. Revoke all sessions:
DELETE /sessions/me/all

CHAT MANAGEMENT EXAMPLE:
========================

1. Create a new chat:
POST /chat/
{
    "title": "Syria History Discussion",
    "description": "Learning about Syria's rich history",
    "context": "Focus on ancient civilizations and modern developments",
    "language": "en",
    "model_preference": "gemini-1.5-flash",
    "max_tokens": 2000,
    "temperature": 0.7
}

2. Send a message to the chat:
POST /chat/{chat_id}/messages
{
    "message": "What is the history of Damascus?",
    "message_type": "text",
    "language": "en",
    "priority": "normal"
}

3. Get chat messages:
GET /chat/{chat_id}/messages?limit=50&offset=0

4. Add feedback to AI response:
POST /chat/messages/{message_id}/feedback
{
    "rating": 5,
    "feedback_type": "helpful",
    "comment": "Very informative response",
    "category": "accuracy"
}

5. Update chat settings:
PUT /chat/settings
{
    "default_language": "en",
    "default_model": "gemini-1.5-pro",
    "default_max_tokens": 3000,
    "default_temperature": 0.8,
    "auto_archive_after_days": 60,
    "enable_voice_input": true,
    "enable_file_upload": true
}

6. Get chat analytics:
GET /chat/analytics?date_range_start=2024-01-01&date_range_end=2024-01-31

7. Export chat:
POST /chat/{chat_id}/export
{
    "format": "json",
    "include_metadata": true,
    "include_context": true
}

8. Bulk actions on chats:
POST /chat/bulk-action
{
    "chat_ids": ["chat_id_1", "chat_id_2"],
    "action": "archive"
}

================================================================================
                              DEPLOYMENT
================================================================================

Environment Variables:
- DATABASE_URL: PostgreSQL connection string
- REDIS_URL: Redis connection string
- JWT_SECRET_KEY: Secret key for JWT tokens
- GOOGLE_API_KEY: Google Gemini API key
- GOOGLE_CLIENT_ID: Google OAuth client ID
- GOOGLE_CLIENT_SECRET: Google OAuth client secret
- SMTP_HOST: SMTP server host
- SMTP_PORT: SMTP server port
- SMTP_USERNAME: SMTP username
- SMTP_PASSWORD: SMTP password
- QDRANT_URL: Qdrant vector database URL

Docker Deployment:
```bash
# Build and run with Docker Compose
docker-compose up -d

# Or build manually
docker build -t syriagpt .
docker run -p 8000:8000 syriagpt
```

Health Checks:
- GET /test/health - System health
- GET /auth/health - Authentication service health
- GET /smtp/health - SMTP service health
- GET /intelligent-qa/health - AI service health

================================================================================
                              SUPPORT
================================================================================

For technical support and questions:
- Email: support@syriagpt.com
- Documentation: https://docs.syriagpt.com
- GitHub: https://github.com/syriagpt/api
- Issues: https://github.com/syriagpt/api/issues

API Version: 1.0.0
Last Updated: 2024
Maintained by: Syria GPT Team

================================================================================
9. CHAT MANAGEMENT ENDPOINTS (/chat)
================================================================================

POST /chat/
Description: Create a new chat
Authentication: Required
Request Body:
{
    "title": "Syria History Discussion",
    "description": "Learning about Syria's rich history",
    "context": "Focus on ancient civilizations and modern developments",
    "language": "en",
    "model_preference": "gemini-1.5-flash",
    "max_tokens": 2000,
    "temperature": 0.7
}

Response (200):
{
    "chat": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "title": "Syria History Discussion",
        "description": "Learning about Syria's rich history",
        "context": "Focus on ancient civilizations and modern developments",
        "language": "en",
        "model_preference": "gemini-1.5-flash",
        "max_tokens": 2000,
        "temperature": 0.7,
        "message_count": 0,
        "is_archived": false,
        "is_pinned": false,
        "last_message_at": null,
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "Chat created successfully"
}

GET /chat/{chat_id}
Description: Get chat details
Authentication: Required
Parameters:
- chat_id: UUID of the chat
- include_messages: Include chat messages (default: true)

Response (200):
{
    "chat": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "title": "Syria History Discussion",
        "description": "Learning about Syria's rich history",
        "context": "Focus on ancient civilizations and modern developments",
        "language": "en",
        "model_preference": "gemini-1.5-flash",
        "max_tokens": 2000,
        "temperature": 0.7,
        "message_count": 2,
        "is_archived": false,
        "is_pinned": false,
        "last_message_at": "2024-01-01T00:00:00Z",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "messages": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440001",
            "chat_id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "message": "Tell me about Damascus",
            "message_type": "text",
            "attachments": null,
            "context": null,
            "language": "en",
            "priority": "normal",
            "is_ai_response": false,
            "ai_model_used": null,
            "processing_time_ms": null,
            "confidence_score": null,
            "feedback_rating": null,
            "feedback_comment": null,
            "created_at": "2024-01-01T00:00:00Z"
        }
    ],
    "user": null,
    "analytics": null
}

PUT /chat/{chat_id}
Description: Update chat
Authentication: Required
Parameters:
- chat_id: UUID of the chat

Request Body:
{
    "title": "Updated Syria History Discussion",
    "description": "Updated description",
    "is_pinned": true
}

Response (200):
{
    "chat": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "title": "Updated Syria History Discussion",
        "description": "Updated description",
        "context": "Focus on ancient civilizations and modern developments",
        "language": "en",
        "model_preference": "gemini-1.5-flash",
        "max_tokens": 2000,
        "temperature": 0.7,
        "message_count": 2,
        "is_archived": false,
        "is_pinned": true,
        "last_message_at": "2024-01-01T00:00:00Z",
        "created_at": "2024-01-01T00:00:00Z",
        "updated_at": "2024-01-01T00:00:00Z"
    },
    "message": "Chat updated successfully"
}

DELETE /chat/{chat_id}
Description: Delete chat
Authentication: Required
Parameters:
- chat_id: UUID of the chat

Response (200):
{
    "status": "success",
    "message": "Chat deleted successfully"
}

GET /chat/
Description: Search chats
Authentication: Required
Query Parameters:
- title: Search by title
- language: Filter by language (auto, en, ar)
- model_preference: Filter by model (gemini-1.5-flash, gemini-1.5-pro, gemini-2.0-flash)
- is_archived: Filter by archived status
- is_pinned: Filter by pinned status
- created_after: Filter by creation date (after)
- created_before: Filter by creation date (before)
- updated_after: Filter by update date (after)
- updated_before: Filter by update date (before)
- message_count_min: Minimum message count
- message_count_max: Maximum message count
- page: Page number (default: 1)
- page_size: Page size (default: 10, max: 100)

Response (200):
{
    "chats": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "title": "Syria History Discussion",
            "description": "Learning about Syria's rich history",
            "context": "Focus on ancient civilizations and modern developments",
            "language": "en",
            "model_preference": "gemini-1.5-flash",
            "max_tokens": 2000,
            "temperature": 0.7,
            "message_count": 2,
            "is_archived": false,
            "is_pinned": true,
            "last_message_at": "2024-01-01T00:00:00Z",
            "created_at": "2024-01-01T00:00:00Z",
            "updated_at": "2024-01-01T00:00:00Z"
        }
    ],
    "total_count": 1,
    "page": 1,
    "page_size": 10,
    "total_pages": 1
}

POST /chat/{chat_id}/messages
Description: Send message
Authentication: Required
Parameters:
- chat_id: UUID of the chat

Request Body:
{
    "message": "What is the history of Damascus?",
    "message_type": "text",
    "attachments": null,
    "context": null,
    "language": "en",
    "priority": "normal"
}

Response (200):
{
    "message": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "chat_id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "message": "What is the history of Damascus?",
        "message_type": "text",
        "attachments": null,
        "context": null,
        "language": "en",
        "priority": "normal",
        "is_ai_response": false,
        "ai_model_used": null,
        "processing_time_ms": null,
        "confidence_score": null,
        "feedback_rating": null,
        "feedback_comment": null,
        "created_at": "2024-01-01T00:00:00Z"
    },
    "ai_response": {
        "id": "550e8400-e29b-41d4-a716-446655440002",
        "chat_id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "550e8400-e29b-41d4-a716-446655440000",
        "message": "Damascus is one of the oldest continuously inhabited cities in the world...",
        "message_type": "text",
        "attachments": null,
        "context": null,
        "language": "en",
        "priority": "normal",
        "is_ai_response": true,
        "ai_model_used": "gemini-1.5-flash",
        "processing_time_ms": 1500,
        "confidence_score": 0.95,
        "feedback_rating": null,
        "feedback_comment": null,
        "created_at": "2024-01-01T00:00:00Z"
    },
    "processing_time_ms": 1500,
    "message": "Message sent successfully"
}

GET /chat/{chat_id}/messages
Description: Get chat messages
Authentication: Required
Parameters:
- chat_id: UUID of the chat
- limit: Number of messages to retrieve (default: 100, max: 1000)
- offset: Message offset (default: 0)

Response (200):
{
    "status": "success",
    "message": "Messages retrieved successfully",
    "data": {
        "messages": [
            {
                "id": "550e8400-e29b-41d4-a716-446655440001",
                "chat_id": "550e8400-e29b-41d4-a716-446655440000",
                "user_id": "550e8400-e29b-41d4-a716-446655440000",
                "message": "What is the history of Damascus?",
                "message_type": "text",
                "attachments": null,
                "context": null,
                "language": "en",
                "priority": "normal",
                "is_ai_response": false,
                "ai_model_used": null,
                "processing_time_ms": null,
                "confidence_score": null,
                "feedback_rating": null,
                "feedback_comment": null,
                "created_at": "2024-01-01T00:00:00Z"
            }
        ],
        "total_count": 1,
        "limit": 100,
        "offset": 0
    }
}

POST /chat/messages/{message_id}/feedback
Description: Add feedback
Authentication: Required
Parameters:
- message_id: UUID of the message

Request Body:
{
    "rating": 5,
    "feedback_type": "helpful",
    "comment": "Very informative response",
    "category": "accuracy"
}

Response (200):
{
    "message_id": "550e8400-e29b-41d4-a716-446655440002",
    "rating": 5,
    "feedback_type": "helpful",
    "comment": "Very informative response",
    "category": "accuracy",
    "created_at": "2024-01-01T00:00:00Z",
    "message": "Feedback added successfully"
}

GET /chat/settings
Description: Get chat settings
Authentication: Required

Response (200):
{
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "default_language": "auto",
    "default_model": "gemini-1.5-flash",
    "default_max_tokens": 2000,
    "default_temperature": 0.7,
    "auto_archive_after_days": 30,
    "max_chats_per_user": 100,
    "max_messages_per_chat": 1000,
    "enable_voice_input": true,
    "enable_file_upload": true,
    "enable_image_analysis": true,
    "enable_context_memory": true,
    "enable_chat_history": true,
    "enable_analytics": true,
    "enable_feedback": true,
    "updated_at": "2024-01-01T00:00:00Z"
}

PUT /chat/settings
Description: Update chat settings
Authentication: Required

Request Body:
{
    "default_language": "en",
    "default_model": "gemini-1.5-pro",
    "default_max_tokens": 3000,
    "default_temperature": 0.8,
    "auto_archive_after_days": 60,
    "max_chats_per_user": 150,
    "max_messages_per_chat": 1500,
    "enable_voice_input": true,
    "enable_file_upload": true,
    "enable_image_analysis": true,
    "enable_context_memory": true,
    "enable_chat_history": true,
    "enable_analytics": true,
    "enable_feedback": true
}

Response (200):
{
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "default_language": "en",
    "default_model": "gemini-1.5-pro",
    "default_max_tokens": 3000,
    "default_temperature": 0.8,
    "auto_archive_after_days": 60,
    "max_chats_per_user": 150,
    "max_messages_per_chat": 1500,
    "enable_voice_input": true,
    "enable_file_upload": true,
    "enable_image_analysis": true,
    "enable_context_memory": true,
    "enable_chat_history": true,
    "enable_analytics": true,
    "enable_feedback": true,
    "updated_at": "2024-01-01T00:00:00Z"
}

GET /chat/analytics
Description: Get chat analytics
Authentication: Required
Query Parameters:
- date_range_start: Start date for analytics
- date_range_end: End date for analytics
- group_by: Grouping interval (hour, day, week, month) - default: day
- include_message_content: Include message content in analytics (default: false)
- include_user_metrics: Include user metrics (default: true)
- include_model_metrics: Include model metrics (default: true)

Response (200):
{
    "total_chats": 25,
    "total_messages": 150,
    "ai_responses": 125,
    "average_response_time_ms": 1200.5,
    "user_satisfaction_score": 4.2,
    "most_used_language": "en",
    "most_used_model": "gemini-1.5-flash",
    "daily_stats": [],
    "weekly_stats": [],
    "monthly_stats": []
}

POST /chat/bulk-action
Description: Bulk action on chats
Authentication: Required

Request Body:
{
    "chat_ids": ["550e8400-e29b-41d4-a716-446655440000", "550e8400-e29b-41d4-a716-446655440001"],
    "action": "archive"
}

Response (200):
{
    "success_count": 2,
    "failed_count": 0,
    "failed_chats": [],
    "message": "Successfully archived 2 chats"
}

POST /chat/{chat_id}/export
Description: Export chat
Authentication: Required
Parameters:
- chat_id: UUID of the chat

Request Body:
{
    "format": "json",
    "include_metadata": true,
    "include_context": true,
    "include_attachments": false,
    "date_range_start": null,
    "date_range_end": null
}

Response (200):
{
    "export_id": "550e8400-e29b-41d4-a716-446655440003",
    "format": "json",
    "download_url": "https://example.com/exports/chat_export.json",
    "file_size_bytes": 15420,
    "expires_at": "2024-01-08T00:00:00Z",
    "message": "Chat exported successfully"
}

GET /chat/stats
Description: Get chat statistics
Authentication: Required

Response (200):
{
    "total_chats": 25,
    "active_chats": 20,
    "archived_chats": 5,
    "pinned_chats": 3,
    "total_messages": 150,
    "ai_responses": 125,
    "average_messages_per_chat": 6.0,
    "average_response_time_ms": 1200.5,
    "chats_created_today": 2,
    "chats_created_this_week": 8,
    "chats_created_this_month": 25,
    "most_active_hour": 14,
    "most_used_language": "en",
    "most_used_model": "gemini-1.5-flash"
}

================================================================================
10. ADDITIONAL SESSION ENDPOINTS (/sessions)
================================================================================

GET /sessions/
Description: Get all sessions for the current user
Authentication: Required

Response (200):
{
    "sessions": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440000",
            "user_id": "550e8400-e29b-41d4-a716-446655440000",
            "session_token": "session_token_here",
            "device_info": "Chrome 120.0.0.0 on Windows",
            "ip_address": "192.168.1.1",
            "user_agent": "Mozilla/5.0...",
            "location": "Damascus, Syria",
            "is_active": true,
            "is_mobile": false,
            "last_activity_at": "2024-01-01T00:00:00Z",
            "expires_at": "2024-01-02T00:00:00Z",
            "created_at": "2024-01-01T00:00:00Z",
            "updated_at": "2024-01-01T00:00:00Z"
        }
    ],
    "total_count": 1,
    "page": 1,
    "page_size": 10,
    "total_pages": 1
}

POST /sessions/logout
Description: Logout from specific session or all sessions
Authentication: Required

Request Body:
{
    "session_id": "550e8400-e29b-41d4-a716-446655440000",
    "logout_all": false
}

Response (200):
{
    "status": "success",
    "message": "Successfully logged out from session",
    "session_id": "550e8400-e29b-41d4-a716-446655440000"
}

POST /sessions/refresh
Description: Refresh access token using refresh token
Authentication: Required

Request Body:
{
    "refresh_token": "refresh_token_here"
}

Response (200):
{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer",
    "expires_in": 1800,
    "message": "Token refreshed successfully"
}

DELETE /sessions/cleanup
Description: Clean up expired sessions (admin endpoint)
Authentication: Required (Admin privileges)

Response (200):
{
    "message": "Successfully cleaned up 25 expired sessions",
    "cleaned_sessions": 25
}

GET /sessions/current
Description: Get current session information
Authentication: Required

Response (200):
{
    "user_id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "message": "Current session information - session tracking via JWT tokens"
}
